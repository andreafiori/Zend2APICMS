<?php if ($this->redirectRoute and $this->redirectRouteTableSetter): ?>
    <?php
    $routeParams = $this->params()->fromRoute('admin/datatable', array('lang'=>'it','tablesetter' => $this->redirectRouteTableSetter) );
    $urlRedirect = str_replace('//', '/', $this->url('admin/datatable', array('lang' => $routeParams['lang'], 'tablesetter' => $routeParams['tablesetter'])));
    ?>
    <script>
        top.location = '<?php echo $urlRedirect ?>';
    </script>
<?php endif; ?>

<!-- Breadcrumb -->
<?php if (isset($this->showBreadcrumb)): ?>
<ul class="breadcrumb">
    <li><a href="<?php echo $this->basepath() ?>" title="Home page">Home</a> <span class="divider"></span></li>

    <?php if ( is_array($this->formBreadCrumbCategory) ): ?>

        <?php foreach($this->formBreadCrumbCategory as $breadcrumb): ?>
            <?php if (isset($this->formBreadCrumbCategoryLink)): ?>
                <li><a href="<?php echo $this->formBreadCrumbCategoryLink ?>" title="<?php echo $this->formBreadCrumbCategory ?>"><?php echo $this->formBreadCrumbCategory ?></a> <span class="divider"></span></li>
            <?php else: ?>
                <li class="active"><?php echo $this->formBreadCrumbCategory ?></li>
            <?php endif; ?>
        <?php endforeach; ?>

    <?php elseif( isset($this->formBreadCrumbCategory) ): ?>
        <?php if (isset($this->formBreadCrumbCategoryLink)): ?>
            <li><a href="<?php echo $this->formBreadCrumbCategoryLink ?>" title="<?php echo $this->formBreadCrumbCategory ?>"><?php echo $this->formBreadCrumbCategory ?></a> <span class="divider"></span></li>
        <?php else: ?>
            <li class="active"><?php echo $this->formBreadCrumbCategory ?></li>
        <?php endif; ?>
    <?php endif; ?>

    <li class="active"><?php echo $this->formTitle ?></li>
</ul>
<?php endif; ?>

<!-- Message -->
<div style="padding: 1%; margin: 0" class="alert alert-<?php if ($this->messageType) echo $this->messageType; else echo "info"; ?>" id="formdataresultmessage">
    <h1><?php echo $this->messageTitle ?></h1>
    <div><?php echo $this->messageText ?></div>
    <div>&nbsp;</div>

    <?php if (isset($this->messageList)): ?>
    <div><ul>
        <?php foreach($this->messageList as $message): ?>
        <li><?php echo $message ?></li>
        <?php endforeach; ?>
    </ul></div>
    <?php endif; ?>

    <?php if ($this->messageShowFormLink and !$this->reloadPage and !$this->redirectRoute and !$this->redirectRouteTableSetter): ?>
        <div id="showFormContainer">
            &raquo; <a href="javascript:void(0)" id="reShowForm">Mostra form</a>
        </div>
    <?php endif; ?>

    <?php if ($this->redirectRoute and $this->redirectRouteTableSetter): ?>
    <div><h2>Attendere: redirect in corso...</h2></div>
    <?php endif; ?>
</div>

<div>&nbsp;</div>


<script>

<?php if ($this->reloadPage): ?>
    top.location.reload();
<?php endif; ?>

$('#reShowForm').click(function() {
    $('#formcontainer').show();
    $('input:submit').attr('disabled', false);
    $('#showFormContainer').hide();
    
    $("#formdataresultmessage").fadeOut("slow", function () {
        $("#formdataresultmessage").remove();
    });
});
</script>
